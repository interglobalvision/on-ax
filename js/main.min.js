function l(e){"use strict";console.log(e)}function detectSpecs(){container=document.querySelector("#threeContainer"),prompt=document.querySelector("#prompt"),info=document.querySelector("#info"),title=document.querySelector("#title"),container.style.opacity=0;var e=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return!1}}(),a=function(){return!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)}();a?e?(prompt.innerHTML="To enjoy the full experience allow camera access",init()):prompt.innerHTML="No WebGL support detected. Please try restarting the browser.":prompt.innerHTML="This demo requires webcam support (Chrome or Opera)."}function init(){document.onselectstart=function(){return!1},prompt.classList.add("active"),params=new WCMParams,gui=new dat.GUI,gui.add(params,"zoom",.1,5).name("Zoom").onChange(onParamsChange),gui.add(params,"mOpac",0,1).name("Mesh Opacity").onChange(onParamsChange),gui.add(params,"wfOpac",0,.5).name("Grid Opacity").onChange(onParamsChange),gui.add(params,"contrast",1,5).name("Contrast").onChange(onParamsChange),gui.add(params,"saturation",0,2).name("Saturation").onChange(onParamsChange),gui.add(params,"zDepth",0,1e3).name("Z Depth"),gui.add(params,"noiseStrength",0,60).name("Noise Strength"),gui.add(params,"noiseSpeed",0,.05).name("Noise Speed"),gui.add(params,"noiseScale",0,1).name("Noise Scale"),gui.add(params,"invertZ").name("Invert Z"),gui.close(),gui.domElement.style.display="none",scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(fov,window.innerWidth/window.innerHeight,1,5e3),camera.target=new THREE.Vector3(0,0,0),scene.add(camera),camera.position.z=300,video=document.createElement("video"),video.width=vidWidth,video.height=vidHeight,video.preload="auto",video.loop=!0,window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({video:!0},function(e){webcamOn=!0,video.src=window.URL.createObjectURL(e),prompt.classList.remove("active"),gui.domElement.style.display="inline",threeReady=!0,console.log("Three is ready")},function(e){var a=document.createElement("source");a.src="vid/bg.webm",a.type='video/webm; codecs="vp8, vorbis"';var t=document.createElement("source");t.src="vid/bg.mp4",t.type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"',video.appendChild(a),video.appendChild(t),video.addEventListener("canplay",function(){video.play(),prompt.classList.remove("active"),gui.domElement.style.display="inline",threeReady=!0,console.log("Three is ready")})}),videoTexture=new THREE.Texture(video),world3D=new THREE.Object3D,scene.add(world3D),geometry=new THREE.PlaneGeometry(640,480,canvasWidth,canvasHeight),geometry.dynamic=!0,meshMaterial=new THREE.MeshBasicMaterial({opacity:1,map:videoTexture}),wireMaterial=new THREE.MeshBasicMaterial({opacity:.15,color:7759809,wireframe:!0,blending:THREE.AdditiveBlending,transparent:!0,wireframeLinejoin:"round"});var e=new THREE.Mesh(geometry,wireMaterial);world3D.add(e),e.position.z=9,renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.sortObjects=!1,renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),vidCanvas=document.createElement("canvas"),document.body.appendChild(vidCanvas),vidCanvas.style.position="absolute",vidCanvas.style.display="none",ctx=vidCanvas.getContext("2d"),document.addEventListener("mousemove",onMouseMove,!1),window.addEventListener("resize",onResize,!1),document.addEventListener("mousewheel",onWheel,!1),window.self===window.top&&(isIframe=!0,container.addEventListener("click",showInfo,!1),document.getElementById("closeBtn").addEventListener("click",hideInfo,!1),title.addEventListener("click",showInfo,!1)),renderer.domElement.addEventListener("webglcontextlost",function(e){prompt.style.display="inline",prompt.classList.add("active"),prompt.innerHTML="WebGL Context Lost. Please try reloading the page."},!1),onResize(),animate()}function WCMParams(){this.zoom=1.1,this.mOpac=0,this.wfOpac=.2,this.contrast=2,this.saturation=1.1,this.invertZ=!0,this.zDepth=100,this.noiseStrength=91,this.noiseScale=.01,this.noiseSpeed=2e-4}function onParamsChange(){meshMaterial.opacity=params.mOpac,wireMaterial.opacity=params.wfOpac,container.style.webkitFilter="contrast("+params.contrast+") saturate("+params.saturation+")"}function getZDepths(){if(noisePosn+=params.noiseSpeed,arpPlayer.isPlaying)var e=arpPlayer.getAnalyserData();else var e=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];var a=e[2]/64;a+=e[3]/64;var t=e[8]/128,n=e[11]/128,i=params.noiseScale+a/1e4,o=params.noiseStrength,r=params.zDepth*n;ctx.drawImage(video,0,0,canvasWidth+1,canvasHeight+1),pixels=ctx.getImageData(0,0,canvasWidth+1,canvasHeight+1).data;for(var s=0;s<canvasWidth+1;s++)for(var d=0;d<canvasHeight+1;d++){var c=new THREE.Color(getColor(s,d)),l=getBrightness(c),m=r*l-r/1.3;m+=perlin.noise(s*i,d*i,t)*o,m*=n,params.invertZ&&(m=-m),geometry.vertices[d*(canvasWidth+1)+s].z+=(m-geometry.vertices[d*(canvasWidth+1)+s].z)/5}geometry.verticesNeedUpdate=!0}function onMouseMove(e){webcamOn?(mouseX=(e.clientX-windowHalfX)/windowHalfX,mouseY=(e.clientY-windowHalfY)/windowHalfY):(mouseX=20*(e.clientX-windowHalfX)/windowHalfX,mouseY=20*(e.clientY-windowHalfY)/windowHalfY)}function animate(){video.readyState===video.HAVE_ENOUGH_DATA&&(videoTexture.needsUpdate=!0,getZDepths()),requestAnimationFrame(animate),render()}function render(){time+=.01,world3D.scale=new THREE.Vector3(params.zoom,params.zoom,1),world3D.rotation.x+=(mouseY*tiltAmount-world3D.rotation.x)*tiltSpeed,world3D.rotation.y+=(mouseX*tiltAmount-world3D.rotation.y)*tiltSpeed,renderer.render(scene,camera)}function onResize(){renderer.setSize(window.innerWidth,window.innerHeight),camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2}function getColor(e,a){var t=4*(Math.floor(a)*(canvasWidth+1)+Math.floor(e)),n={r:pixels[t+0],g:pixels[t+1],b:pixels[t+2],a:pixels[t+3]};return(n.r<<16)+(n.g<<8)+n.b}function getBrightness(e){return.34*e.r+.5*e.g+.16*e.b}function hideInfo(e){e.preventDefault(),info.classList.remove("active"),arpPlayer.isPlaying||document.getElementById("playPlayer").classList.add("active")}function showInfo(e){e.preventDefault(),info.classList.add("active"),document.getElementById("playPlayer").classList.remove("active")}function onWheel(e){params.zoom+=.002*e.wheelDelta,params.zoom=Math.max(params.zoom,.1),params.zoom=Math.min(params.zoom,5),gui.__controllers[0].updateDisplay()}function saveImage(){render(),window.open(renderer.domElement.toDataURL("image/png"))}function l(e){"use strict";console.log(e)}document.body.style.width=window.innerWidth+"px",document.body.style.height=window.innerHeight+"px",navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var container,scene,camera,renderer,controls,stats,videoTexture,fov=70,canvasWidth=160,canvasHeight=120,vidWidth=1280,vidHeight=960,tiltSpeed=.2,tiltAmount=.1,perlin=new ImprovedNoise,camera,scene,renderer,mouseX=0,mouseY=0,windowHalfX,windowHalfY,video,videoTexture,world3D,geometry,vidCanvas,ctx,pixels,noisePosn=0,wireMaterial,meshMaterial,container,params,title,info,prompt,time=0,gui,musicNoise,threeReady=!1,webcamOn=!1,isIframe=!1;CLIENT_ID="1af5bd17adc32f47529ce064b5e03361";var arpPlayer={audioContext:"",sourceNode:"",audioPlayer:null,analyserNode:null,dataArray:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],soundBuffer:null,isReady:!1,isPlaying:!1,bpmCounter:null,init:function(){l("init");var e=this;e.setBodySize(),window.addEventListener("resize",e.setBodySize,!1),document.getElementById("pause-btn").addEventListener("click",function(e){e.preventDefault(),arpPlayer.isPlaying===!0&&arpPlayer.pause()}),document.getElementById("play-btn").addEventListener("click",function(e){e.preventDefault(),arpPlayer.isPlaying===!1&&arpPlayer.play()}),e.audioContext=new(window.AudioContext||window.webkitAudioContext),e.audioPlayer=document.getElementById("audioPlayer"),e.isPlaying&&e.pause(),e.audioPlayer.addEventListener("canplay",function(){e.sourceNode=e.audioContext.createMediaElementSource(e.audioPlayer),e.analyserNode=e.audioContext.createAnalyser(),e.analyserNode.fftSize=32,e.dataArray=new Uint8Array(e.analyserNode.frequencyBinCount),e.sourceNode.connect(e.analyserNode),e.analyserNode.connect(e.audioContext.destination),e.sourceNode.buffer=e.soundBuffer,e.isReady=!0,console.log("Player is ready")}),detectSpecs()},play:function(){var e=this;video.paused&&video.play(),e.bpmCounter=setInterval(function(){var a=e.audioPlayer.currentTime;a>8&&a<9&&isIframe&&(info.classList.add("active"),document.getElementById("playPlayer").classList.remove("active")),a>0&&a<.484&&(webcamOn||(params.invertZ=!1)),a>13.552&&a<14.52&&(params.invertZ=!0,params.noiseScale=.01),a>60.016&&a<60.984&&(webcamOn?video.pause():params.invertZ=!1,params.noiseScale=.05),a>75.504&&a<76.472&&(params.invertZ=!0,webcamOn&&video.play()),a>85.184&&a<86.152&&(params.noiseScale=.01),a>185.856&&a<186.824&&(params.invertZ=!1,params.zDepth=150,params.noiseScale=.05),a>197.472&&a<198.44&&(params.invertZ=!0,params.zDepth=100,params.noiseScale=.01)},242),e.audioPlayer.play(),container.style.opacity=1,document.getElementById("pausePlayer").classList.add("active"),document.getElementById("playPlayer").classList.remove("active"),e.isPlaying=!0},pause:function(){var e=this;container.style.opacity=0,clearInterval(e.bpmCounter),e.audioPlayer.pause(),video.pause(),e.isPlaying=!1,document.getElementById("pausePlayer").classList.remove("active"),0==document.getElementById("info").classList&&document.getElementById("playPlayer").classList.add("active")},getAnalyserData:function(){var e=this;return e.analyserNode.getByteTimeDomainData(e.dataArray),e.dataArray},setBodySize:function(){document.body.style.width=window.innerWidth+"px",document.body.style.height=window.innerHeight+"px"}};$(document).ready(function(){"use strict";arpPlayer.init();var e=setInterval(function(){1==arpPlayer.isReady&&1==threeReady&&(document.getElementById("playPlayer").classList.add("active"),clearInterval(e))},300)}),$(window).load(function(){});
//# sourceMappingURL=main.min.js.map
